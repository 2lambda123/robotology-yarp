PROJECT(libYARP_OS)

# need to give explicit path to include for some build systems
INCLUDE_DIRECTORIES(${CMAKE_SOURCE_DIR}/src/libYARP_OS/include include ${ACE_INCLUDE_DIR})

# We just intend to use cmake to create visual studio project files -
# so ok not to manually include list of source code
AUX_SOURCE_DIRECTORY(src libcode)

INCLUDE(YarpReqLib)

ADD_LIBRARY(YARP_OS ${libcode})

# cannot just call the executable "yarp" because that is directory name
# and makefiles generated by cmake break
ADD_EXECUTABLE(yarp yarp/yarp.cpp)

TARGET_LINK_LIBRARIES(yarp YARP_OS)

AUX_SOURCE_DIRECTORY(harness harnesscode)
ADD_EXECUTABLE(harness_os ${harnesscode})

TARGET_LINK_LIBRARIES(harness_os YARP_OS)

GET_TARGET_PROPERTY(EXEC harness_os LOCATION)

# add in our tests
FOREACH(X ${harnesscode})
	  GET_FILENAME_COMPONENT(XN ${X} NAME_WE)
	  ADD_TEST(YARP_OS::${XN} ${EXEC} regression ${XN})
ENDFOREACH(X $(harnesscode))

